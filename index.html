<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Performansi Teknisi</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

  <aside class="sidebar">
    <div class="brand">
      <div class="logo">üìä</div>
      <div class="brand-text">
        <div class="brand-title">Dashboard</div>
        <div class="brand-sub">Performansi Teknisi</div>
      </div>
    </div>

    <nav class="menu">
      <button class="menu-btn active">üìå Dashboard</button>
      <button class="menu-btn" id="btnReload">üîÑ Reload</button>
    </nav>

    <div class="sidebar-footer">
      <div class="hint">
        <span class="hint-dot"></span>
        <div>
          <div class="hint-title">Auto Refresh</div>
          <div class="hint-sub">Setiap 60 detik</div>
        </div>
      </div>
    </div>
  </aside>

  <main class="main">
    <header class="topbar">
      <div>
        <h1>Performansi Teknisi</h1>
        <p class="subtitle">Data realtime dari Spreadsheet (API Apps Script)</p>
      </div>

      <div class="topbar-right">
        <div class="badge" id="badgeAPI">
          <span class="badge-dot" id="badgeDot"></span>
          <span id="badgeText">API: Checking...</span>
        </div>
        <div class="time" id="nowTime">-</div>
      </div>
    </header>

    <section class="filters card">
      <div class="field">
        <label>Tanggal Dari</label>
        <input type="date" id="dateFrom" />
      </div>

      <div class="field">
        <label>Tanggal Sampai</label>
        <input type="date" id="dateTo" />
      </div>

      <div class="field">
        <label>Filter STO</label>
        <select id="stoFilter">
          <option value="">Semua STO</option>
        </select>
      </div>

      <div class="field field-wide">
        <label>Cari Teknisi</label>
        <input type="text" id="searchTeknisi" placeholder="contoh: Rey Wijaya" />
      </div>

      <div class="actions">
        <button class="btn primary" id="btnRefresh">Refresh</button>
        <button class="btn ghost" id="btnExport">Export CSV</button>
      </div>
    </section>

    <section class="stats">
      <div class="card stat">
        <div class="stat-title">Total Tiket</div>
        <div class="stat-value" id="sTotal">0</div>
      </div>

      <div class="card stat">
        <div class="stat-title">Total OPEN</div>
        <div class="stat-value" id="sOpen">0</div>
      </div>

      <div class="card stat">
        <div class="stat-title">Total CLOSE</div>
        <div class="stat-value" id="sClose">0</div>
      </div>

      <div class="card stat highlight">
        <div class="stat-title">Close Ticket</div>
        <div class="stat-value" id="sCloseTicket">0</div>
      </div>
    </section>

    <section class="grid">
      <div class="card box">
        <div class="box-head">
          <h3>üèÜ Top Teknisi</h3>
          <span class="muted">Top 10</span>
        </div>
        <div id="topList" class="top-list">
          <div class="empty">Tidak ada data.</div>
        </div>
      </div>

      <div class="card box">
        <div class="box-head">
          <h3>üìà Grafik Close Ticket</h3>
          <span class="muted">Top 10</span>
        </div>
        <div class="chart-wrap">
          <canvas id="chartClose"></canvas>
        </div>
      </div>
    </section>

    <section class="card table-card">
      <div class="table-head">
        <h3>üìå Detail Performansi</h3>
        <span class="muted" id="dataCount">0 data</span>
      </div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Tanggal</th>
              <th>STO</th>
              <th>Teknisi</th>
              <th>Total</th>
              <th>Open</th>
              <th>Close</th>
              <th>Close Ticket</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <tr><td colspan="8" class="empty-cell">Data belum dimuat...</td></tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- MODAL -->
  <div class="modal" id="modal">
    <div class="modal-box">
      <div class="modal-head">
        <h3 id="modalTitle">Detail</h3>
        <button class="icon-btn" id="btnCloseModal">‚úï</button>
      </div>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>